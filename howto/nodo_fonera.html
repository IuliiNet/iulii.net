<!DOCTYPE html>
	<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="it"> <![endif]-->
	<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="it"> <![endif]-->
	<!--[if IE 8]>    <html class="no-js lt-ie9" lang="it"> <![endif]-->
	<!--[if gt IE 8]><!--> <html class="no-js" lang="it"> <!--<![endif]-->
	<head>
        	<meta charset="utf-8" />
<!--		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /> -->
        	<meta name="author" content="lucapost" />
	        <meta name="description" content="" />
        	<title>IuliiNet | nodo fonera</title>
  		<meta name="viewport" content="width=device-width">
		<link rel="stylesheet" type="text/css" media="all" href="/css/reset.css" />
		<link rel="stylesheet" type="text/css" media="all" href="/css/text.css" />
		<link rel="stylesheet" type="text/css" media="all" href="/css/960.css" />
		<link rel="stylesheet" type="text/css" media="all" href="/css/hashgrid.css" />
		<link rel="stylesheet" type="text/css" media="all" href="/css/style.css" />
  		<script src="/js/modernizr.js"></script>
		<link rel="icon" type="image/png" href="/img/iuliinetlogo.png">
	</head>
	<body id="top">
		<div class="social">	
			<div class="tt-share">
				<a href="https://twitter.com/share" class="twitter-share-button" data-url="http://iulii.net" data-text="rete mesh libera e decentralizzata in friuli #iuliinet #ninux" data-via="iuliinet" data-count="vertical">Tweet</a>
			</div>
			<div class="g-plusone" data-size="tall" data-href="http://iulii.net">
			</div><br/>
			<div class="fb-like" data-href="https://www.facebook.com/Iuliinet" data-send="false" data-layout="box_count" data-width="60" data-show-faces="false" data-font="arial">
			</div>
		</div>
		<header class="container_12 clearfix">
			<div class="grid_8">
				<hgroup>
					<h1><a href="/">IuliiNet</a></h1>
					<h2><a href="/">rete mesh libera e decentralizzata in friuli</a></h2>
				</hgroup>
			</div>
			<div class="grid_4">
				<a href="/">
					<img class="iuliinetlogo" title="iuliinet logo" alt="iuliinet logo" src="/img/iuliinetlogo.png">
				</a>
			</div>
			<div class="clear"></div>
		</header>
		<section class="container_12 clearfix">
			<article class="grid_8"><h3>nodo su fonera 2.0g</h3>
<p>In questa pagina si approfondisce la configurazione di un router fonera 2.0g (modello 2201) come nodo generico della rete IuliiNet.</p>
<h4>interfaccie</h4>
<ul>
<li>wifi<ul>
<li>ap0 access point;</li>
<li>adhoc0 adhoc per le mesh;</li>
</ul>
</li>
<li>ethernet<ul>
<li>eth0.1 accesso client;</li>
<li>eth0.2 mesh;</li>
</ul>
</li>
<li>batman-adv gw_mode client;</li>
<li>nessun servizio attivo (no dhcp, no gateway, ecc.);</li>
</ul>
<h4>links utili:</h4>
<ul>
<li><a href="http://wiki.openwrt.org/toh/fon/fonera">wiki.openwrt.org/toh/fon/fonera</a> wiki openwrt fonera 2.0g;</li>
<li><a href="http://wiki.openwrt.org/doc/howto/build" title="building openwrt">wiki.openwrt.org/doc/howto/build</a> informazioni compilazione sorgenti openwrt.</li>
<li><a href="https://github.com/iuliinet/devices/tree/master/fonera2.0g">github.com/iuliinet/devices/tree/master/fonera2.0g</a> file di configurazione;</li>
</ul>
<h4>files di configurazione:</h4>
<p>/etc/config/wireless</p>
<pre><code>config wifi-device  radio0
   option type      mac80211
   option channel   11
   option hwmode    11g
   option path  'platform/ar231x-wmac.0'`

config wifi-iface              
   option device   radio0
   option network  lan
   option mode     ap
   option ssid     IuliiNet-ap
   option encryption none

config wifi-iface
   option device   radio0
   option network  mesh0
   option ifname   adhoc0
   option mode     adhoc
   option ssid     IuliiNet-mesh
</code></pre>
<p>/etc/config/batman-adv</p>
<pre><code>config 'mesh' 'bat0'
    option 'interfaces' 'mesh0 mesh1'
    option 'aggregated_ogms'
    option 'ap_isolation'
    option 'bonding'
    option 'fragmentation'
    option 'gw_bandwidth'
    option 'gw_mode'
    option 'gw_sel_class'
    option 'log_level'
    option 'orig_interval'
    option 'vis_mode'
    option 'bridge_loop_avoidance'
</code></pre>
<p>/etc/config/network</p>
<pre><code>config interface 'loopback'
    option ifname 'lo'
    option proto 'static'
    option ipaddr '127.0.0.1'
    option netmask '255.0.0.0'

config interface 'lan'
    option type 'bridge'
    option proto 'static'
    option ipaddr '192.168.1.1'
    option netmask '255.255.255.0'
    option ifname 'eth0.1 bat0'
    option ip6addr '2001:470:7023:1::0018:84d0:80bc/64'

config interface 'mesh0'
    option ifname 'adhoc0'
    option mtu '1528'
    option proto 'none'

config interface 'mesh1'
    option ifname 'eth0.2'
    option proto 'none'
</code></pre>
<p>/etc/rc.local</p>
<pre><code>#!/bin/sh

IPV6PREFIX="2001:470:7023:1" # ipv6 /64 prefix
PUBKEY=""  #ssh pubkey
HOSTNAME="fonera"   #hostname

uci set system.@system[0].hostname=$HOSTNAME
uci commit system

/etc/init.d/dnsmasq disable
/etc/init.d/nodogsplash disable
/etc/init.d/radvd disable      
/etc/init.d/firewall disable

IPV6="$IPV6PREFIX::$(cat /sys/class/net/eth0/address |awk -F: '{print $1$2":"$3$4":"$5$6}')/64"
uci set network.lan.ip6addr=$IPV6                                                              
uci commit network

echo $PUBKEY &gt; /etc/dropbear/authorized_keys

exit 0
</code></pre>
    			</article>
			<div class="grid_4 column">
				<div class="navigation">
					<div class="path">
						<b>path</b>: <a href="../index.html">home</a> / <a href="index.html">howto</a> / nodo fonera
					</div>
					<nav>
						
<ul>
<li class="level-1"><a href="/partecipare.html">partecipare</a></li>
<li class="level-1"><a href="/rete/index.html">rete</a>
	<ul>
	<li class="level-2"><a href="/rete/nodi.html">nodi</a></li>
	<li class="level-2"><a href="/rete/routing.html">routing</a></li>
	<li class="level-2"><a href="/rete/ipv6.html">ipv6</a></li>
	<li class="level-2"><a href="/rete/servizi.html">servizi</a></li>
	</ul>
</li>
<li class="level-1"><a href="/howto/index.html">howto</a>
	<ul>
	<li class="level-2"><a class="current" href="/howto/nodo_fonera.html">nodo fonera</a></li>
	</ul>
</li>
<li class="level-1"><a href="/contatti.html">contatti</a></li>
<li class="level-1"><a href="/links.html">links</a></li>
</ul>

					</nav>
					<div class="flattr">
						<a href="http://flattr.com/thing/715037/iulii-net" target="_blank">
							<img src="http://api.flattr.com/button/flattr-badge-large.png" alt="Flattr this" title="Flattr this"/>
						</a>
					</div>
				</div>
<!--				<iframe class="mappa" width="300" height="300" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="https://maps.google.com/?q=http:%2F%2Fmap.ninux.org%2Fnodes.kml&amp;t=h&amp;ie=UTF8&amp;ll=46.067514,13.348389&amp;spn=1.112876,2.469177&amp;output=embed" /> -->
				<div class="tt-widget">
					<script charset="utf-8" src="http://widgets.twimg.com/j/2/widget.js"></script>
					<script>
					new TWTR.Widget({
					  version: 2,
					  type: 'profile',
					  rpp: 5,
					  interval: 30000,
					  width: 'auto',
					  height: 300,
					  theme: {
					    shell: {
					      background: '#55a2d5',
					      color: '#ffffff'
					    },
					    tweets: {
					      background: '#ffffff',
					      color: '#000000',
					      links: '#55a2d5'
					    }
					  },
					  features: {
					    scrollbar: false,
					    loop: false,
					    live: false,
					    behavior: 'all'
					  }
					}).render().setUser('iuliinet').start();
					</script>
				</div>
			</div>
			<div class="clear"></div>
		</section>
		<footer class="container_12 clearfix">
			<div class="grid_12">
				<a href="#top" title="back to top" class="backtotop">back to top</a>
				<div class="foot">
					<p>&copy; 2012 <a href="http://iulii.net" title="iulii.net website">iulii.net</a> | <a rel="license" href="http://creativecommons.org/licenses/by-nc/3.0/">license CC by-nc</a> | edit: 20121218 11:50:54 AM</p>
				</div>
			</div>
			<div class="clear"></div>
		</footer>	
<!--[if lt IE 7]><p class=chromeframe>Your browser is <em>ancient!</em> <a href="http://browsehappy.com/">Upgrade to a different browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to experience this site.</p><![endif]-->
	  	<script src="/js/jquery.js"></script> 
  		<script src="/js/plugins.js"></script>
  		<script src="/js/main.js"></script>
  		<script src="/js/hashgrid.js"></script>
		<div id="fb-root"></div>
		<script>(function(d, s, id) {
		  var js, fjs = d.getElementsByTagName(s)[0];
		  if (d.getElementById(id)) return;
		  js = d.createElement(s); js.id = id;
		  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
		  fjs.parentNode.insertBefore(js, fjs);
		  }(document, 'script', 'facebook-jssdk'));
		</script>
		<script>
			!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
		</script>
		<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
  		<script>
    			var _gaq=[['_setAccount','UA-6164762-12'],['_trackPageview']];
    			(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
    			g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
    			s.parentNode.insertBefore(g,s)}(document,'script'));
  		</script>
</body>
</html>